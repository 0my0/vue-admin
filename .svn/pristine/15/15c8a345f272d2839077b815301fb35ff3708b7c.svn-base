{"remainingRequest":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\thread-loader\\dist\\cjs.js!E:\\vueProject\\admin\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js!E:\\vueProject\\admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\vueProject\\admin\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vueProject\\admin\\vue-element-admin\\src\\views\\sales\\first-hand\\coupon-manager\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\vueProject\\admin\\vue-element-admin\\src\\views\\sales\\first-hand\\coupon-manager\\index.vue","mtime":1576313202347},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport SystemManager from '@/api/system-manager';\nimport Sales from '@/api/sales';\nimport { getToken } from '@/utils/auth';\nimport toJsonData from '@/api/jsonformdata';\nexport default {\n  name: 'coupon-manager',\n  data: function data() {\n    var _this = this;\n\n    return {\n      formInline: {\n        site_id: '',\n        game_id: ''\n      },\n      formLabelWidth: '120px',\n      siteData: [],\n      gameData: [],\n      sequence: 1,\n      tableData: [],\n      couponForm: {\n        site_id: '',\n        game_ids: [],\n        title: '',\n        code: '',\n        price: '',\n        stime: '',\n        ltime: '',\n        num: '',\n        coupon_type: ''\n      },\n      gameIds: [],\n      checked: false,\n      dialogFormVisible: false,\n      dialogAddFormVisible: false,\n      dialogPersonFormVisible: false,\n      dialogPermissionVisible: false,\n      couponType: ['一次性优惠券', '多次优惠券'],\n      isCouponHidden: true,\n      token: getToken(),\n      pickerOptionsStart: {\n        disabledDate: function disabledDate(time) {\n          var endDateVal = new Date(_this.couponForm.ltime).getTime();\n\n          if (endDateVal) {\n            return time.getTime() > endDateVal - 0;\n          }\n\n          return time.getTime() < Date.now() - 8.64e7;\n        }\n      },\n      pickerOptionsEnd: {\n        disabledDate: function disabledDate(time) {\n          var beginDateVal = new Date(_this.couponForm.stime).getTime();\n\n          if (beginDateVal) {\n            return time.getTime() < beginDateVal - 0;\n          }\n        }\n      }\n    };\n  },\n  methods: {\n    getSiteIndex: function getSiteIndex() {\n      var _this2 = this;\n\n      SystemManager.getSiteIndex(this.token).then(function (data) {\n        _this2.siteData = data.data;\n      });\n    },\n    showDialog: function showDialog() {\n      this.dialogFormVisible = true;\n      this.couponForm = {\n        site_id: '',\n        game_ids: [],\n        title: '',\n        code: '',\n        price: '',\n        stime: '',\n        ltime: '',\n        num: '',\n        coupon_type: '多次优惠券'\n      };\n    },\n    handleCheckAllChange: function handleCheckAllChange(val) {\n      var _this3 = this;\n\n      this.couponForm.game_ids = [];\n\n      if (val == true) {\n        this.gameData.forEach(function (item) {\n          _this3.couponForm.game_ids.push(item.game_id);\n        });\n      } else {\n        this.couponForm.game_ids = [];\n      }\n    },\n    getGameIndex: function getGameIndex() {\n      var _this4 = this;\n\n      this.gameIds = [];\n      SystemManager.getGameIndex(this.token).then(function (data) {\n        _this4.gameData = data.data;\n      });\n    },\n    onSubmit: function onSubmit() {\n      var _this5 = this;\n\n      Sales.searchCoupon(this.formInline.site_id, this.formInline.game_id, this.token).then(function (data) {\n        _this5.tableData = data.data;\n      });\n    },\n    addCoupon: function addCoupon() {\n      var _this6 = this;\n\n      var postData = toJsonData.JsonData(this.couponForm);\n      Sales.addCoupon(postData, this.token).then(function (data) {\n        _this6.$message({\n          message: data.data.log,\n          type: 'success'\n        });\n\n        _this6.getCouponIndex();\n\n        _this6.closeDialog();\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    closeDialog: function closeDialog() {\n      this.dialogFormVisible = false;\n    },\n    deleteCoupon: function deleteCoupon(coupon_id) {\n      var _this7 = this;\n\n      Sales.deleteCoupon(coupon_id, this.token).then(function (data) {\n        _this7.$message({\n          message: data.data.log,\n          type: 'success'\n        });\n\n        _this7.getCouponIndex();\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    changeCoupon: function changeCoupon() {\n      var _this8 = this;\n\n      this.formInline.game_id = '';\n      Sales.changeCoupon(this.formInline.site_id, this.token).then(function (data) {\n        _this8.gameData = data.data;\n      });\n    },\n    addChangeCoupon: function addChangeCoupon() {\n      var _this9 = this;\n\n      this.couponForm.game_id = '';\n      this.checked = false;\n      this.couponForm.game_ids = [];\n      Sales.changeCoupon(this.couponForm.site_id, this.token).then(function (data) {\n        _this9.gameData = data.data;\n      });\n    },\n    changeCouponType: function changeCouponType(val) {\n      this.couponForm.code = '';\n      this.couponForm.stime = '';\n      this.couponForm.ltime = '';\n      this.couponForm.num = '';\n\n      if (val == '一次性优惠券') {\n        this.isCouponHidden = false;\n      } else {\n        this.isCouponHidden = true;\n      }\n    },\n    getCouponIndex: function getCouponIndex() {\n      var _this10 = this;\n\n      Sales.getCouponIndex(this.token).then(function (data) {\n        _this10.tableData = data.data;\n      });\n    }\n  },\n  created: function created() {\n    this.getSiteIndex();\n    this.getGameIndex();\n    this.getCouponIndex();\n    this.couponForm.coupon_type = this.couponType[1];\n  }\n};",null]}
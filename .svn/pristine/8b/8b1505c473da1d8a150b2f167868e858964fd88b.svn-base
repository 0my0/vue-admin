{"remainingRequest":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js!E:\\vueProject\\admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\vueProject\\admin\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vueProject\\admin\\vue-element-admin\\src\\views\\system-manager\\web-config.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\vueProject\\admin\\vue-element-admin\\src\\views\\system-manager\\web-config.vue","mtime":1577687701038},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"E:\\\\vueProject\\\\admin\\\\vue-element-admin\\\\node_modules\\\\@babel\\\\runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nvar _systemManager = _interopRequireDefault(require(\"@/api/system-manager\"));\n\nvar _auth = require(\"@/utils/auth\");\n\nvar _jsonformdata = _interopRequireDefault(require(\"@/api/jsonformdata\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: 'web-config',\n  data: function data() {\n    return {\n      tableData: [],\n      gameConfig: [],\n      dialogEditFormVisible: false,\n      optionVisible: false,\n      dialogType: 'add',\n      formLabelWidth: '120px',\n      top: 0,\n      left: 0,\n      siteId: '',\n      editSiteForm: {\n        site_name: '',\n        site_url: '',\n        yewu: []\n      },\n      siteBusiness: [{\n        'yewu': '销售'\n      }, {\n        'yewu': '采购'\n      }, {\n        'yewu': '资源'\n      }],\n      token: (0, _auth.getToken)()\n    };\n  },\n  methods: {\n    getSiteIndex: function getSiteIndex() {\n      var _this = this;\n\n      _systemManager.default.getSiteIndex(this.token).then(function (data) {\n        _this.tableData = data.data;\n      });\n    },\n    rowClassName: function rowClassName(_ref) {\n      var row = _ref.row,\n          rowIndex = _ref.rowIndex;\n      row.id = rowIndex;\n    },\n    gameConfigLink: function gameConfigLink(index, row) {\n      // console.log(row)\n      this.siteId = this.tableData[row.id].site_id;\n      this.$router.push({\n        path: \"/system/game-config\",\n        query: {\n          id: this.siteId\n        }\n      });\n    },\n    createSite: function createSite() {\n      var _this2 = this;\n\n      var postData = _jsonformdata.default.JsonData(this.editSiteForm);\n\n      var isAdd = this.dialogType === 'add';\n\n      if (isAdd) {\n        _systemManager.default.createSite(postData, this.token).then(function (data) {\n          _this2.$message({\n            message: data.data.log,\n            type: 'success'\n          });\n\n          _this2.getSiteIndex();\n\n          _this2.closeDialog();\n        }).catch(function (error) {\n          console.log(error);\n        });\n      } else {\n        _systemManager.default.editSite(postData, this.siteId, this.token).then(function (data) {\n          _this2.$message({\n            message: data.data.log,\n            type: 'success'\n          });\n\n          _this2.getSiteIndex();\n\n          _this2.closeDialog();\n        }).catch(function (error) {\n          console.log(error);\n        });\n      }\n\n      this.editSiteForm = {\n        site_name: '',\n        site_url: '',\n        yewu: []\n      };\n    },\n    deleteSite: function deleteSite() {\n      var _this3 = this;\n\n      this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _systemManager.default.deleteSite(_this3.siteId, _this3.token).then(function (data) {\n          _this3.$message({\n            message: data.data.log,\n            type: 'success'\n          });\n\n          _this3.getSiteIndex();\n\n          _this3.closeDialog();\n        });\n      }).catch(function () {\n        _this3.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    rightClick: function rightClick(row, column, e) {\n      console.log(row);\n      e.preventDefault();\n      this.publicMenu(e);\n      this.siteId = row.site_id;\n      this.editSiteForm = {\n        'site_name': row.site_name,\n        site_url: row.site_url,\n        yewu: row.yewu.split(\",\")\n      }, this.editSiteForm.site_name = row.site_name;\n      this.optionVisible = true;\n    },\n    publicMenu: function publicMenu(e) {\n      var menuMinWidth = 105;\n      var offsetLeft = this.$el.getBoundingClientRect().left; // container margin left\n\n      var offsetWidth = this.$el.offsetWidth; // container width\n\n      var maxLeft = offsetWidth - menuMinWidth; // left boundary\n\n      var left = e.clientX - offsetLeft + 15; // 15: margin right\n\n      if (left > maxLeft) {\n        this.left = maxLeft;\n      } else {\n        this.left = left;\n      }\n\n      this.top = e.pageY - 80;\n    },\n    handleAddSite: function handleAddSite() {\n      this.dialogType = 'add';\n      this.dialogEditFormVisible = true;\n      this.editSiteForm = {\n        site_name: '',\n        site_url: '',\n        yewu: []\n      };\n    },\n    handleEditSite: function handleEditSite() {\n      this.dialogType = 'edit';\n      this.dialogEditFormVisible = true;\n    },\n    closeDialog: function closeDialog() {\n      this.dialogEditFormVisible = false;\n    },\n    closeMenu: function closeMenu() {\n      this.optionVisible = false;\n    }\n  },\n  created: function created() {\n    this.getSiteIndex();\n  },\n  watch: {\n    optionVisible: function optionVisible(value) {\n      if (value) {\n        document.body.addEventListener('click', this.closeMenu);\n      } else {\n        document.body.removeEventListener('click', this.closeMenu);\n      }\n    }\n  }\n};\nexports.default = _default;",null]}
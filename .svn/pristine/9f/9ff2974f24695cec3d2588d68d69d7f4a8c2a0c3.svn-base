{"remainingRequest":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vueProject\\admin\\vue-element-admin\\src\\views\\system-manager\\web-config\\web-config.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\vueProject\\admin\\vue-element-admin\\src\\views\\system-manager\\web-config\\web-config.vue","mtime":1573810365139},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport SystemManager from  '@/api/system-manager'\nimport { getToken} from  '@/utils/auth'\nimport toJsonData from '@/api/jsonformdata'\nexport default {\n  name: 'web-config',\n  data() {\n    return {\n      tableData: [],\n      gameConfig: [],\n      dialogEditFormVisible: false,\n      optionVisible: false,\n      dialogType: 'add',\n      formLabelWidth: '120px',\n      top: 0,\n      left: 0,\n      siteId: '',\n      editSiteForm: {\n        site_name: '',\n        site_url: '',\n        yewu: []\n      },\n      siteBusiness: [\n        {\n          'yewu': '销售'\n        },\n        {\n          'yewu': '采购'\n        },\n        {\n          'yewu': '资源'\n        }\n      ],\n      token: getToken()\n    }\n  },\n  methods: {\n    getSiteIndex() {\n      SystemManager.getSiteIndex(this.token).then(data => {\n        this.tableData=data.data\n      })\n    },\n    createSite() {\n      const postData = toJsonData.JsonData(this.editSiteForm);\n      const isAdd = this.dialogType === 'add'\n      if(isAdd) {\n        SystemManager.createSite(postData,this.token).then(data => {\n          this.$message({\n            message: data.data.log,\n            type: 'success'\n          })\n          this.getSiteIndex();\n          this.closeDialog();\n        }).catch(error => {\n          console.log(error)\n        })\n      }else{\n        SystemManager.editSite(postData,this.siteId,this.token).then(data => {\n          this.$message({\n            message: data.data.log,\n            type: 'success'\n          })\n          this.getSiteIndex();\n          this.closeDialog();\n        }).catch(error => {\n          console.log(error)\n        })\n      }\n      this.editSiteForm={\n        site_name: '',\n        site_url: '',\n        yewu: []\n      }\n    },\n    deleteSite() {\n      this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        SystemManager.deleteSite(this.siteId, this.token).then(data => {\n          this.$message({\n            message:data.data.log,\n            type: 'success'\n          })\n          this.getSiteIndex();\n          this.closeDialog();\n        })\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    rightClick(row, column, e) {\n      e.preventDefault();\n      this.publicMenu(e)\n      this.siteId = row.site_id;\n      this.editSiteForm = {\n        'site_name': row.site_name,\n        site_url: row.site_url,\n        yewu: (row.yewu).split(\",\")\n      },\n      this.editSiteForm.site_name = row.site_name\n      this.optionVisible = true\n    },\n    publicMenu(e){\n      const menuMinWidth = 105\n      const offsetLeft = this.$el.getBoundingClientRect().left // container margin left\n      const offsetWidth = this.$el.offsetWidth // container width\n      const maxLeft = offsetWidth - menuMinWidth // left boundary\n      const left = e.clientX - offsetLeft + 15 // 15: margin right\n      if (left > maxLeft) {\n        this.left = maxLeft\n      } else {\n        this.left = left\n      }\n      this.top = e.clientY - 80\n    },\n    handleAddSite() {\n      this.dialogType = 'add'\n      this.dialogEditFormVisible = true\n    },\n    handleEditSite() {\n      this.dialogType = 'edit'\n      this.dialogEditFormVisible = true\n    },\n    closeDialog() {\n      this.dialogEditFormVisible = false;\n    },\n    closeMenu() {\n      this.optionVisible = false\n    }\n  },\n  created(){\n    this.getSiteIndex();\n  },\n  watch: {\n    optionVisible(value) {\n      if(value) {\n        document.body.addEventListener('click', this.closeMenu)\n      }else{\n        document.body.removeEventListener('click', this.closeMenu)\n      }\n    }\n  }\n}\n",null]}
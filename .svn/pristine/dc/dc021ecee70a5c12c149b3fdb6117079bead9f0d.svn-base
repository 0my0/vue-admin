{"remainingRequest":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vueProject\\admin\\vue-element-admin\\src\\views\\system-manager\\currency-exchange-rate.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\vueProject\\admin\\vue-element-admin\\src\\views\\system-manager\\currency-exchange-rate.vue","mtime":1574046818027},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vueProject\\admin\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport SystemManager from '@/api/system-manager'\nimport {getToken} from '@/utils/auth'\nimport toJsonData from '@/api/jsonformdata'\nexport default {\n  name: 'currencyExchangeRate',\n  data() {\n    return{\n      tableData: [],\n      token: getToken(),\n      dialogEditFormVisible: false,\n      optionVisible: false,\n      dialogType: 'add',\n      formLabelWidth: '120px',\n      countryId: '',\n      left: '0px',\n      top: '0px',\n      editCurrencyForm: {\n        country_name: '',\n        country: '',\n        stamp: '',\n        exchange_rate: '0.0000'\n      }\n    }\n  },\n  methods: {\n    getCountryIndex() {\n      SystemManager.getCountryIndex(this.token).then(data => {\n        this.tableData = data.data\n        this.countryId = data.data.country_id\n      })\n    },\n    createCountry() {\n      const postData = toJsonData.JsonData(this.editCurrencyForm);\n      const isAdd = this.dialogType === 'add'\n      if(isAdd) {\n        SystemManager.createCountry(postData, this.token).then(data => {\n          this.$message({\n            message: data.data.log,\n            type: 'success'\n          })\n          this.getCountryIndex()\n          this.closeDialog();\n        })\n      }else{\n        SystemManager.editCountry(postData,this.countryId,this.token).then(data => {\n          this.$message({\n            message: data.data.log,\n            type: 'success'\n          })\n          this.getCountryIndex()\n          this.closeDialog();\n        })\n      }\n      this.editCurrencyForm={\n        country_name: '',\n        country: '',\n        stamp: '',\n        exchange_rate: '0.0000'\n      }\n    },\n    deleteCountry() {\n      this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        SystemManager.deleteCountry(this.countryId, this.token).then(data => {\n          this.$message({\n            message:data.data.log,\n            type: 'success'\n          })\n          this.getCountryIndex();\n          this.closeDialog();\n        })\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    handleAddCurrency() {\n      this.dialogType = 'add';\n      this.dialogEditFormVisible = true;\n    },\n    installCountry(){\n      SystemManager.installCountry(this.token).then(data => {\n        this.$message({\n          message: data.data.log,\n          type: 'success'\n        })\n        this.getCountryIndex()\n      })\n    },\n    handleEditCurrency() {\n      this.dialogType = 'edit';\n      this.dialogEditFormVisible = true;\n    },\n    closeDialog() {\n      this.dialogEditFormVisible = false;\n    },\n    closeMenu() {\n      this.optionVisible = false\n    },\n    rightClick(row, column, e) {\n      e.preventDefault();\n      this.publicMenu(e)\n      console.log(row)\n      this.countryId = row.country_id\n      this.editCurrencyForm={\n        country_name: row.country_name,\n        country: row.country,\n        stamp:  row.stamp,\n        exchange_rate: row.exchange_rate\n      }\n      this.optionVisible = true\n    },\n    publicMenu(e){\n      const menuMinWidth = 105\n      const offsetLeft = this.$el.getBoundingClientRect().left // container margin left\n      const offsetWidth = this.$el.offsetWidth // container width\n      const maxLeft = offsetWidth - menuMinWidth // left boundary\n      const left = e.clientX - offsetLeft + 15 // 15: margin right\n      if (left > maxLeft) {\n        this.left = maxLeft\n      } else {\n        this.left = left\n      }\n      this.top = e.clientY - 80\n    },\n  },\n  created() {\n    this.getCountryIndex();\n  },\n  watch: {\n    optionVisible(value){\n      if(value) {\n        document.body.addEventListener('click', this.closeMenu)\n      }else{\n        document.body.removeEventListener('click', this.closeMenu)\n      }\n    }\n  }\n}\n",null]}